import{d as S,u as C,r as u,k as D,c as i,a as e,b as I,t as s,M,N as T,O as B,G as d,K as $,T as N,P as V,F as z,Q as E,R as F,o as r,_ as L}from"./index-CjulRFg0.js";const f=v=>(E("data-v-3c65b5a6"),v=v(),F(),v),U={class:"admin-dashboard"},j={class:"dashboard-header"},A={key:0,class:"loading"},O={key:1,class:"error"},P={key:2,class:"submissions-table-container"},G={class:"submissions-table"},J=f(()=>e("th",null,"Time",-1)),K=["onClick"],Q={class:"modal-content"},R={class:"details-grid"},q={class:"detail-item"},H={class:"detail-item"},W={class:"detail-item"},X={class:"detail-item"},Y={class:"detail-item"},Z={class:"detail-item"},x={class:"detail-item"},ee={class:"message-box"},te=f(()=>e("hr",null,null,-1)),se={class:"edit-form"},ae={class:"form-group"},ne={value:"pending"},le={value:"processing"},oe={value:"completed"},ie={class:"form-group"},de={class:"modal-actions"},re=["disabled"],ue=S({__name:"Dashboard",setup(v){const{t:ce}=C(),c=u([]),m=u(!0),p=u(""),n=u(null),o=u({status:"pending",notes:""}),h=u(!1),y=async()=>{m.value=!0;try{const t=localStorage.getItem("admin_token"),l=await fetch("/api/admin/submissions",{headers:{Authorization:`Bearer ${t}`}});if(!l.ok)throw new Error("Failed to fetch");c.value=await l.json()}catch(t){p.value=t.message}finally{m.value=!1}},b=t=>new Date(t).toLocaleString(),k=t=>{n.value=t,o.value={status:t.status||"pending",notes:t.notes||""}},_=()=>{n.value=null},w=async()=>{h.value=!0;try{const t=localStorage.getItem("admin_token");if(!(await fetch("/api/admin/submissions",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${t}`},body:JSON.stringify({id:n.value.id,...o.value})})).ok)throw new Error("Save failed");const a=c.value.findIndex(g=>g.id===n.value.id);a!==-1&&(c.value[a]={...c.value[a],...o.value}),_()}catch(t){alert(t.message)}finally{h.value=!1}};return D(y),(t,l)=>(r(),i("div",U,[e("div",j,[e("h1",null,s(t.$t("admin.submissions")),1)]),m.value?(r(),i("div",A,"Loading...")):p.value?(r(),i("div",O,s(p.value),1)):(r(),i("div",P,[e("table",G,[e("thead",null,[e("tr",null,[e("th",null,s(t.$t("name")),1),e("th",null,s(t.$t("phone")),1),e("th",null,s(t.$t("city")),1),e("th",null,s(t.$t("admin.status")),1),J,e("th",null,s(t.$t("admin.actions")),1)])]),e("tbody",null,[(r(!0),i(M,null,T(c.value,a=>(r(),i("tr",{key:a.id},[e("td",null,s(a.name),1),e("td",null,s(a.phone),1),e("td",null,s(a.city),1),e("td",null,[e("span",{class:z(["status-badge",a.status||"pending"])},s(t.$t(`admin.${a.status||"pending"}`)),3)]),e("td",null,s(b(a.created_at)),1),e("td",null,[e("button",{onClick:g=>k(a),class:"btn-text"},s(t.$t("admin.edit")),9,K)])]))),128))])])])),n.value?(r(),i("div",{key:3,class:"modal-overlay",onClick:B(_,["self"])},[e("div",Q,[e("h2",null,s(t.$t("admin.edit")),1),e("div",R,[e("div",q,[e("strong",null,s(t.$t("name"))+":",1),d(" "+s(n.value.name),1)]),e("div",H,[e("strong",null,s(t.$t("phone"))+":",1),d(" "+s(n.value.phone),1)]),e("div",W,[e("strong",null,s(t.$t("email"))+":",1),d(" "+s(n.value.email),1)]),e("div",X,[e("strong",null,s(t.$t("city"))+":",1),d(" "+s(n.value.city),1)]),e("div",Y,[e("strong",null,s(t.$t("address"))+":",1),d(" "+s(n.value.address),1)]),e("div",Z,[e("strong",null,s(t.$t("plan"))+":",1),d(" "+s(n.value.service_plan_id),1)]),e("div",x,[e("strong",null,s(t.$t("interest"))+":",1),d(" "+s(n.value.product_type),1)])]),e("div",ee,[e("strong",null,s(t.$t("message"))+":",1),e("p",null,s(n.value.message),1)]),te,e("div",se,[e("div",ae,[e("label",null,s(t.$t("admin.status")),1),$(e("select",{"onUpdate:modelValue":l[0]||(l[0]=a=>o.value.status=a)},[e("option",ne,s(t.$t("admin.pending")),1),e("option",le,s(t.$t("admin.processing")),1),e("option",oe,s(t.$t("admin.completed")),1)],512),[[N,o.value.status]])]),e("div",ie,[e("label",null,s(t.$t("admin.notes")),1),$(e("textarea",{"onUpdate:modelValue":l[1]||(l[1]=a=>o.value.notes=a),rows:"3"},null,512),[[V,o.value.notes]])])]),e("div",de,[e("button",{onClick:_,class:"btn-secondary"},s(t.$t("admin.cancel")),1),e("button",{onClick:w,disabled:h.value,class:"btn-primary"},s(h.value?"Saving...":t.$t("admin.save")),9,re)])])])):I("",!0)]))}}),he=L(ue,[["__scopeId","data-v-3c65b5a6"]]);export{he as default};
